// Generated by CoffeeScript 1.10.0
(function() {
  var check_price, update_line_participant;

  this.Participant_inline_class_added = function(row) {
    update_line_participant(row);
    return jsSelect(row);
  };

  check_price = function(row) {
    var birthday, csrf, distance, insurance, url;
    distance = $("select[name$='distance']", row).val();
    birthday = $("input[name$='birthday']", row).val();
    insurance = $("select[name$='insurance']", row).val();
    csrf = document.getElementsByName('csrfmiddlewaretoken')[0].value;
    url = $("select[name$='distance']", row).data('url');
    return $.ajax({
      url: url,
      type: 'POST',
      data: {
        csrfmiddlewaretoken: csrf,
        distance: distance,
        birthday: birthday,
        insurance: insurance
      },
      dataType: 'json',
      success: function(data) {
        return $('.price', row).html(data.message);
      },
      error: function() {
        return $('.price', row).html('Please enter all details');
      }
    });
  };

  update_line_participant = function(row) {
    var birthday, insurance, ssn;
    ssn = $("input[name$='-ssn']", row);
    birthday = $("input[name$='-birthday']", row).val();
    insurance = $("select[name$='-insurance']", row);
    $('.dateinput', row).datetimepicker({
      format: 'YYYY-MM-DD'
    });
    if (!insurance.val()) {
      $(ssn).parents(".input-wrap").hide();
    }
    insurance.on("selectmenuchange", function(e) {
      var el;
      el = $(ssn).parents(".input-wrap");
      if ($(this).val()) {
        return el.show();
      } else {
        $(ssn).val("");
        return el.hide();
      }
    });
    $("input[name$='-birthday']", row).on("dp.change", function(e) {
      return check_price(row);
    });
    $("select[name$='distance'], select[name$='insurance']", row).on("selectmenuchange", function(e) {
      return check_price(row);
    });
    check_price(row);
    return void 0;
  };

  $(function() {
    var container, i, len, ref, results;
    if ($(".Participant_inline_class")[0]) {
      ref = $('.item:not(.template)');
      results = [];
      for (i = 0, len = ref.length; i < len; i++) {
        container = ref[i];
        results.push(update_line_participant($(container)));
      }
      return results;
    }
  });

}).call(this);

//# sourceMappingURL=01_registration.js.map
