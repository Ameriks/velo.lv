// Generated by CoffeeScript 1.10.0
(function() {
  var check_price, update_line_participant;

  this.Participant_inline_class_added = function(row) {
    return update_line_participant(row);
  };

  check_price = function(row) {
    var birthday, csrf, distance, insurance, url;
    distance = $("select[name$='distance']", row).val();
    birthday = $("select[name$='birthday_year']", row).val();
    insurance = $("[name$='insurance']", row).val();
    csrf = document.getElementsByName('csrfmiddlewaretoken')[0].value;
    url = $(row).parents("form").data('check-price');
    return $.ajax({
      url: url,
      type: 'POST',
      data: {
        csrfmiddlewaretoken: csrf,
        distance: distance,
        birthday_year: birthday,
        insurance: insurance
      },
      dataType: 'json',
      success: function(data) {
        return $('.price', row).html(data.message);
      },
      error: function() {
        return $('.price', row).html('Please enter all details');
      }
    });
  };

  update_line_participant = function(row) {
    var birthday, insurance, ssn;
    ssn = $("input[name$='-ssn']", row);
    birthday = $("input[name$='-birthday']", row).val();
    insurance = $("select[name$='-insurance']", row);
    $(".participant__number", row).html(row.index());
    if (!insurance.val()) {
      $(ssn).parents(".input-wrap").hide();
    }
    insurance.on("selectmenuchange", function(e) {
      var el;
      el = $(ssn).parents(".input-wrap");
      if ($(this).val()) {
        return el.show();
      } else {
        $(ssn).val("");
        return el.hide();
      }
    });
    if (!row.hasClass("noadd")) {
      $("select[name$='-birthday_year'], select[name$='distance'], select[name$='insurance']", row).on("change", function(e) {
        check_price(row);
        return void 0;
      });
      check_price(row);
    }
    return void 0;
  };

  $(function() {
    var container, i, len, ref, results;
    if ($(".Participant_inline_class")[0]) {
      ref = $('.item:not(.template)');
      results = [];
      for (i = 0, len = ref.length; i < len; i++) {
        container = ref[i];
        results.push(update_line_participant($(container)));
      }
      return results;
    }
  });

}).call(this);

//# sourceMappingURL=01_registration.js.map
